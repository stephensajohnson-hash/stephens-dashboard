<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stephens' Dashboard V0.2</title>
    <!-- Load Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Apply smooth transitions to all interactive elements */
        * {
            transition: all 0.2s ease-in-out;
        }
        /* Custom scrollbar for a polished dark-mode look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #111827; /* gray-900 */
        }
        ::-webkit-scrollbar-thumb {
            background: #4B5563; /* gray-600 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6B7280; /* gray-500 */
        }

        /* Set default font to Inter */
        html {
            font-family: 'Inter', sans-serif;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<!-- Main container is set to dark mode -->
<body class="bg-gray-900 text-white min-h-screen p-4 sm:p-8">

    <!-- Header -->
    <header class="mb-10 pt-4 text-center">
        <h1 class="text-5xl font-extrabold text-blue-400 tracking-tight mb-2">
            Stephens' Dashboard <span class="text-gray-300">V0.2</span>
        </h1>
        <p class="text-lg text-gray-400">Your quick-access portal for work, fun, and life.</p>
    </header>

    <!-- Dashboard Content Container (The Grid) -->
    <!-- Grid layout is responsive: 1 column on mobile, 2 on medium screens, 3 on large screens -->
    <main id="dashboard-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-7xl mx-auto">
        <!-- A simple loading indicator -->
        <p id="loading-indicator" class="col-span-full text-center text-gray-400 p-8">Loading dashboard data...</p>
    </main>

    <!-- JavaScript for Data Handling and Rendering -->
    <script>
        const container = document.getElementById('dashboard-container');

        // Function to create an individual link tile
        function createLinkElement(link) {
            const linkTile = document.createElement('a');
            linkTile.href = link.url;
            linkTile.target = '_blank';
            
            // Set up placeholder image if URL fails (or if it's a local file like /images/...)
            const placeholderLetter = link.name.substring(0, 1).toUpperCase();
            const imgHtml = `
                <img
                    src="${link.img}"
                    alt="${link.name} icon"
                    class="w-8 h-8 rounded-full object-cover mr-3 flex-shrink-0"
                    loading="lazy"
                    onerror="this.onerror=null;this.src='https://placehold.co/32x32/1F2937/FFFFFF?text=${placeholderLetter}'"
                />
            `;

            linkTile.className = 'flex items-center p-3 text-gray-200 bg-gray-800 rounded-xl hover:bg-gray-700 hover:scale-[1.02] active:scale-[0.98] transform shadow-lg transition duration-150 ease-in-out';
            linkTile.innerHTML = imgHtml + `<span class="truncate font-medium">${link.name}</span>`;
            
            return linkTile;
        }

        /**
         * Renders the dashboard content based on the fetched data.
         * @param {Object} data - The parsed JSON object containing linkGroups.
         */
        function renderDashboard(data) {
            // Clear the loading message or previous content
            container.innerHTML = ''; 

            if (!data.linkGroups || data.linkGroups.length === 0) {
                container.innerHTML = '<p class="text-gray-500 col-span-full text-center">No link groups found in data.</p>';
                return;
            }

            data.linkGroups.forEach(group => {
                // Create the card container for the group
                const groupCard = document.createElement('div');
                groupCard.className = 'group-card bg-gray-800 border border-gray-700 rounded-2xl p-4 shadow-xl';

                // Create the header
                const header = document.createElement('div');
                // Use the provided color/textColor classes for the header badge
                const headerClasses = `inline-block px-3 py-1 mb-4 rounded-full text-sm font-semibold ${group.color} ${group.textColor}`;
                header.innerHTML = `<h2 class="${headerClasses}">${group.name}</h2>`;

                // Create the links grid
                const linksGrid = document.createElement('div');
                linksGrid.className = 'grid gap-3';

                // Add links to the grid
                if (group.links && group.links.length > 0) {
                    group.links.forEach(link => {
                        const linkElement = createLinkElement(link);
                        linksGrid.appendChild(linkElement);
                    });
                } else {
                    const emptyMessage = document.createElement('p');
                    emptyMessage.className = 'text-gray-500 text-sm italic';
                    emptyMessage.textContent = 'No links in this group.';
                    linksGrid.appendChild(emptyMessage);
                }

                // Append everything to the card and the card to the container
                groupCard.appendChild(header);
                groupCard.appendChild(linksGrid);
                container.appendChild(groupCard);
            });
        }


        /**
         * Initializes the dashboard by fetching data from data.json.
         */
        async function initDashboard() {
            try {
                // Fetch the data.json file from the same directory
                // FIX: Changed fetch to use a root-relative path '/data.json'
                const response = await fetch('/data.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status} (${response.statusText})`);
                }
                
                const dashboardData = await response.json();
                
                // Render the dashboard with the fetched data
                renderDashboard(dashboardData);

            } catch (error) {
                console.error('Failed to load dashboard data:', error);
                
                // Display a user-friendly error message on the screen
                container.innerHTML = `
                    <div class="col-span-full bg-red-900/20 border border-red-700 text-red-400 p-6 rounded-xl text-center">
                        <p class="font-bold mb-2">Error: Could not load configuration data.</p>
                        <p class="text-sm">Please ensure that the 'data.json' file exists in the root directory and is properly formatted. Check the console for details.</p>
                    </div>
                `;
            }
        }

        // Run the initialization function when the window loads
        window.onload = initDashboard;
    </script>

</body>
</html>
